- content_for :head do
  = javascript_include_tag 'http://maps.googleapis.com/maps/api/js?sensor=false'
  = javascript_include_tag 'knockout-2.2.1.debug'
  = javascript_include_tag 'mission_koshow'
  = javascript_include_tag 'jquery.timeago'
#mission_title
  %h1(data-bind="text: title")
  %h2
    %span(data-bind="text: id")
    %span(data-bind="visible: dirty") DIRTY
    %span(data-bind="visible: saving") SAVING
%br
.left
  #left_panel.box.w60
    #form_container
      = label_tag :name, "Event name"
      %br
      = text_field_tag :name, '', :class => "ux-text w58", :size => "2", 
        :placeholder => "Enter the name of this event, e.g. 'Fire on Rangeland'", 
        'data-bind' => 'value: name'
      %br
      %br
      = label_tag "Recruitees"
      %div(data-bind="foreach: mission_skills")
        .mission_skill(data-bind="visible: !_destroy()")
          %span.ux-nstep.w06
            = text_field_tag :req_vols, '', :size => "2", :class => 'req_vols', 
              "data-min" => "1", "data-bind" => "value: req_vols"
          %span
            = select_tag :skill_id, nil, :class => "ux-dropdown w30 skill_id", 
              'data-bind' => "options: $root.activeSkills, optionsText: 'pluralized', optionsValue: 'id', value: skill_id"
          %button.cremove(data-bind="click: $root.removeMissionSkill, visible: $root.visibleSkills() > 1")
          %br
      %button.cadd(data-bind="click: addMissionSkill, visible: activeSkills.length > 1") Recruit for another skill
      %br
      = label_tag :reason, "Description"
      %br
      = text_area_tag :reason, '', :class => "w54 ux-wajbar", 
        :maxlength => "200", :size => "", 
        :placeholder => "Enter the description, e.g 'a single house fire'", 
        'data-bind' => 'value: reason'
      %br
      = label_tag :address
      %br
      %span.small-text Enter an address to find recruits nearby or you can right-click in the map to indicate a location
      = text_field_tag :address, '', :class => "w42 ux-text", 
        :placeholder => "Enter the address, e.g '1710 Trousdale, Burlingame'", 
        "data-bind" => "value: address"
      %button#search_address.fsearch(data-bind="click: findRecruitees") Find recruitees nearby
      %br
      %br
    #map_canvas.map
    .hidden
      #info_window_content
    #mission_distance
.right
  .box.w30
    #mission_status.sbox.grey.StateDisplay
    #mission_message.event-desc
    %hr.shadow
    #scroll
.clear
%br
%hr
#mission_actions.bottom-actions

:javascript
  var DefaultSkill = { id: null, name: 'Volunteer', pluralized: 'Volunteers' };
  var ActiveSkills = #{skills.actives.sort_by(&:name).map { |s| 
    { :id => s.id, 
      :name => s.name, 
      :pluralized => s.pluralized } 
  }.to_json};


